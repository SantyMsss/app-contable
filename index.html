<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Presupuesto Público Municipal - Herramienta Educativa</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>Presupuesto Público Municipal</h1>
        <p>Herramienta para el análisis presupuestal - Contaduría Pública</p>
    </header>
    
    <div class="container">
        <div class="tabs">
            <div class="tab active" data-tab="proyeccion">1. Proyección Inicial</div>
            <div class="tab" data-tab="modificaciones">2. Modificaciones</div>
            <div class="tab" data-tab="indicadores">3. Indicadores</div>
            <div class="tab" data-tab="analisis">4. Análisis</div>
        </div>
        
        <!-- Proyección Inicial -->
        <div id="proyeccion" class="tab-content active">
            <div class="instructions">
                <h3>Instrucciones para la proyección inicial</h3>
                <p>Complete los datos históricos y las proyecciones para el año 2026 según los lineamientos del taller. Recuerde mantener el equilibrio entre ingresos y gastos.</p>
            </div>
            
            <div class="tabs">

            </div>
            
            <div id="ingresos-proy" class="subtab-content active">
                <h2>Presupuesto de Ingresos 2026</h2>
                <table id="ingresos-table">
                    <thead>
                        <tr>
                            <th>Concepto</th>
                            <th>2025 (Base)</th>
                            <th>Tasa Crecimiento (%)</th>
                            <th>2026 (Proyectado)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Ingresos Tributarios -->
                        <tr class="category">
                            <td colspan="4"><strong>Ingresos Tributarios</strong></td>
                        </tr>
                        <tr>
                            <td>Impuesto Predial</td>
                            <td><input type="number" id="predial-2025" class="base-input" value="0"></td>
                            <td><input type="number" id="crec-predial" value="50.2"></td>
                            <td><span id="predial-2026" class="calculated">0</span></td>
                        </tr>
                        <tr>
                            <td>Impuesto de Industria y Comercio</td>
                            <td><input type="number" id="industria-2025" class="base-input" value="0"></td>
                            <td><input type="number" id="crec-industria" value="50.2"></td>
                            <td><span id="industria-2026" class="calculated">0</span></td>
                        </tr>
                        <tr>
                            <td>Tasa por Ocupación de Vías (Nuevo)</td>
                            <td><input type="number" id="tasa-vias-2025" class="base-input" value="0"></td>
                            <td><input type="number" id="crec-tasa-vias" value="0"></td>
                            <td><span id="tasa-vias-2026" class="calculated">0</span></td>
                        </tr>
                        <tr class="add-button-row">
                            <td colspan="4">
                                <button type="button" class="agregar-item-btn" data-categoria="tributarios">AGREGAR</button>
                            </td>
                        </tr>
                        
                        <!-- Ingresos No Tributarios -->
                        <tr class="category">
                            <td colspan="4"><strong>Ingresos No Tributarios</strong></td>
                        </tr>
                        <tr>
                            <td>Venta de Bienes y Servicios</td>
                            <td><input type="number" id="venta-2025" class="base-input" value="0"></td>
                            <td><input type="number" id="crec-venta" value="80"></td>
                            <td><span id="venta-2026" class="calculated">0</span></td>
                        </tr>
                        <tr>
                            <td>Otros Ingresos No Tributarios</td>
                            <td><input type="number" id="otros-no-trib-2025" class="base-input" value="0"></td>
                            <td><input type="number" id="crec-otros-no-trib" value="60"></td>
                            <td><span id="otros-no-trib-2026" class="calculated">0</span></td>
                        </tr>
                        <tr class="add-button-row">
                            <td colspan="4">
                                <button type="button" class="agregar-item-btn" data-categoria="no-tributarios">AGREGAR</button>
                            </td>
                        </tr>
                        
                        <!-- Transferencias -->
                        <tr class="category">
                            <td colspan="4"><strong>Transferencias</strong></td>
                        </tr>
                        <tr>
                            <td>SGP - Propósito General</td>
                            <td><input type="number" id="sgp-2024" class="base-input" value="0"></td>
                            <td>
                                <input type="number" id="crec-sgp-input" value="13" class="tasa-crecimiento-input">
                            </td>
                            <td><span id="sgp-2026" class="calculated">0</span></td>
                        </tr>
                        <tr>
                            <td>FONPET</td>
                            <td><input type="number" id="fonpet-2023" class="base-input" value="0"></td>
                            <td><input type="number" id="crec-fonpet" value="20"></td>
                            <td><span id="fonpet-2026" class="calculated">0</span></td>
                        </tr>
                        <tr class="add-button-row">
                            <td colspan="4">
                                <button type="button" class="agregar-item-btn" data-categoria="transferencias">AGREGAR</button>
                            </td>
                        </tr>
                        
                        <!-- Recursos de Capital -->
                        <tr class="category">
                            <td colspan="4"><strong>Recursos de Capital</strong></td>
                        </tr>
                        <tr>
                            <td>Crédito FINDETER EXTERNO</td>
                            <td><input type="number" id="credito-findeter-2025" class="base-input" value="0"></td>
                            <td><input type="number" id="crec-credito-findeter" value="0"></td>
                            <td><span id="credito-findeter-2026" class="calculated">0</span></td>
                        </tr>

                        <tr>
                            <td>Crédito ENTerritorio</td>
                            <td><input type="number" id="credito-enterritorio-2025" class="base-input" value="0"></td>
                            <td><input type="number" id="crec-credito-enterritorio" value="0"></td>
                            <td><span id="credito-enterritorio-2026" class="calculated">0</span></td>
                        </tr>

                        <tr>
                            <td>Donación Gobierno Alemán</td>
                            <td><input type="number" id="donacion-alemana-2025" class="base-input" value="0"></td>
                            <td><input type="number" id="crec-donacion-alemana" value="0"></td>
                            <td><span id="donacion-alemana-2026" class="calculated">0</span></td>
                        </tr>
                        <tr class="add-button-row">
                            <td colspan="4">
                                <button type="button" class="agregar-item-btn" data-categoria="recursos-capital">AGREGAR</button>
                            </td>
                        </tr>

                        
                        <tr class="total">
                            <td><strong>TOTAL INGRESOS</strong></td>
                            <td><span id="total-ingresos-2025">0</span></td>
                            <td></td>
                            <td><span id="total-ingresos-2026">0</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div id="gastos-proy" class="subtab-content">
                <h2>Presupuesto de Gastos 2026</h2>
                <table id="gastos-table">
                    <thead>
                        <tr>
                            <th>Concepto</th>
                            <th>2025 (Base)</th>
                            <th>Tasa Crecimiento (%)</th>
                            <th>2026 (Proyectado)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Gastos de Funcionamiento -->
                        <tr class="category">
                            <td colspan="4"><strong>Gastos de Funcionamiento</strong></td>
                        </tr>
                        <tr>
                            <td>Servicios Personales</td>
                            <td><input type="number" id="serv-personales-2025" class="base-input" value="0"></td>
                            <td><input type="number" id="crec-serv-personales" value="14" max="14"></td>
                            <td><span id="serv-personales-2026" class="calculated">0</span></td>
                        </tr>
                        <tr>
                            <td>Honorarios Concejales</td>
                            <td><input type="number" id="honorarios-concejales-2025" class="base-input" value="0"></td>
                            <td><input type="number" id="crec-honorarios-concejales" value="0"></td>
                            <td><span id="honorarios-concejales-2026" class="calculated">0</span></td>
                        </tr>
                        <tr>
                            <td>Gastos Generales</td>
                            <td><input type="number" id="gastos-generales-2025" class="base-input" value="0"></td>
                            <td><input type="number" id="crec-gastos-generales" value="8"></td>
                            <td><span id="gastos-generales-2026" class="calculated">0</span></td>
                        </tr>
                        <tr>
                            <td>Sistematización</td>
                            <td><input type="number" id="sistematizacion-2025" class="base-input" value="0"></td>
                            <td><input type="number" id="crec-sistematizacion" value="0"></td>
                            <td><span id="sistematizacion-2026" class="calculated">0</span></td>
                        </tr>
                        <tr>
                            <td>Contribuciones Nómina</td>
                            <td><input type="number" id="contribuciones-nomina-2025" class="base-input" value="0"></td>
                            <td><input type="number" id="crec-contribuciones-nomina" value="0"></td>
                            <td><span id="contribuciones-nomina-2026" class="calculated">0</span></td>
                        </tr>
                        <tr class="add-button-row">
                            <td colspan="4">
                                <button type="button" class="agregar-item-btn" data-categoria="funcionamiento">AGREGAR</button>
                            </td>
                        </tr>
                        
                        <!-- Transferencias -->
                        <tr class="category">
                            <td colspan="4"><strong>Transferencias</strong></td>
                        </tr>
                        <tr>
                            <td>Fondo Local Deporte y Cultura</td>
                            <td><input type="number" id="fondo-deporte-cultura-2025" class="base-input" value="0"></td>
                            <td><input type="number" id="crec-fondo-deporte-cultura" value="0"></td>
                            <td><span id="fondo-deporte-cultura-2026" class="calculated">0</span></td>
                        </tr>

                        <tr>
                            <td>Fondo Local de Salud</td>
                            <td><input type="number" id="fondo-salud-2025" class="base-input" value="0"></td>
                            <td><input type="number" id="crec-fondo-salud" value="0"></td>
                            <td><span id="fondo-salud-2026" class="calculated">0</span></td>
                        </tr>

                        <tr>
                            <td>Concejo Municipal</td>
                            <td><input type="number" id="concejo-municipal-2025" class="base-input" value="0"></td>
                            <td><input type="number" id="crec-concejo-municipal" value="0"></td>
                            <td><span id="concejo-municipal-2026" class="calculated">0</span></td>
                        </tr>

                        <tr>
                            <td>Personería Municipal</td>
                            <td><input type="number" id="personeria-municipal-2025" class="base-input" value="0"></td>
                            <td><input type="number" id="crec-personeria-municipal" value="0"></td>
                            <td><span id="personeria-municipal-2026" class="calculated">0</span></td>
                        </tr>
                        <tr class="add-button-row">
                            <td colspan="4">
                                <button type="button" class="agregar-item-btn" data-categoria="transferencias-gastos">AGREGAR</button>
                            </td>
                        </tr>
                        
                        <!-- Gastos de Inversión -->
                        <tr class="category">
                            <td colspan="4"><strong>Gastos de Inversión</strong></td>
                        </tr>
                        <tr>
                            <td>Proyecto 1</td>
                            <td><input type="number" id="proyecto1-2025" class="base-input" value="0"></td>
                            <td><input type="number" id="crec-proyecto1" value="20"></td>
                            <td><span id="proyecto1-2026" class="calculated">0</span></td>
                        </tr>
                        <tr>
                            <td>Proyecto 2</td>
                            <td><input type="number" id="proyecto2-2025" class="base-input" value="0"></td>
                            <td><input type="number" id="crec-proyecto2" value="24"></td>
                            <td><span id="proyecto2-2026" class="calculated">0</span></td>
                        </tr>
                        <tr>
                            <td>Proyecto 3</td>
                            <td><input type="number" id="proyecto3-2025" class="base-input" value="0"></td>
                            <td><input type="number" id="crec-proyecto3" value="36"></td>
                            <td><span id="proyecto3-2026" class="calculated">0</span></td>
                        </tr>
                        <tr>
                            <td>Proyecto 4</td>
                            <td><input type="number" id="proyecto4-2025" class="base-input" value="0"></td>
                            <td><input type="number" id="crec-proyecto4" value="20"></td>
                            <td><span id="proyecto4-2026" class="calculated">0</span></td>
                        </tr>
                        <tr>
                            <td>Cobertura Salud</td>
                            <td><input type="number" id="cobertura-salud-2025" class="base-input" value="0"></td>
                            <td><input type="number" id="crec-cobertura-salud" value="0"></td>
                            <td><span id="cobertura-salud-2026" class="calculated">0</span></td>
                        </tr>
                        <tr class="add-button-row">
                            <td colspan="4">
                                <button type="button" class="agregar-item-btn" data-categoria="inversion">AGREGAR</button>
                            </td>
                        </tr>

                        <tr>
                            <td colspan="4">
                                <button type="button" id="agregar-gasto">+ Añadir gasto</button>
                            </td>
                        </tr>

                        
                        <tr class="total">
                            <td><strong>TOTAL GASTOS</strong></td>
                            <td><span id="total-gastos-2025">0</span></td>
                            <td></td>
                            <td><span id="total-gastos-2026">0</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div id="balance-alert" class="alert" style="display: none;"></div>
     
        </div>
        
        <!-- Modificaciones Presupuestales -->
        <div id="modificaciones" class="tab-content">
            <div class="instructions">
                <h3>Instrucciones para modificaciones presupuestales</h3>
                <p>Registre aquí las modificaciones al presupuesto inicial durante la vigencia fiscal. Puede agregar adiciones, reducciones o traslados entre diferentes partidas.</p>
            </div>
            
            <div class="instructions">
                <h3>Instrucciones para modificaciones presupuestales</h3>
                <p><strong>📝 Puede agregar múltiples modificaciones de forma consecutiva.</strong> Después de cada registro exitoso, el formulario se limpiará automáticamente para permitir agregar otra modificación.</p>
                <ul>
                    <li><strong>Adición:</strong> Incrementa el valor de un concepto</li>
                    <li><strong>Reducción:</strong> Disminuye el valor de un concepto</li>
                    <li><strong>Traslado:</strong> Mueve valor de un concepto a otro</li>
                </ul>
                <p><em>Nota: Las modificaciones en ingresos requieren distribución en gastos para mantener el equilibrio presupuestal.</em></p>
            </div>
            
            <div class="form-group">
                <label for="tipo-modificacion">Tipo de Modificación:</label>
                <select id="tipo-modificacion" class="form-control">
                    <option value="">-- Seleccione tipo --</option>
                    <option value="adicion">Adición</option>
                    <option value="reduccion">Reducción</option>
                    <option value="traslado">Traslado</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="area-modificacion">Área Afectada:</label>
                <select id="area-modificacion" class="form-control">
                    <option value="">-- Seleccione área --</option>
                    <option value="ingresos">Ingresos</option>
                    <option value="gastos">Gastos</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="concepto-modificacion">Concepto:</label>
                <select id="concepto-modificacion" class="form-control">
                    <!-- Opciones se llenarán dinámicamente -->
                </select>
            </div>
            
            <div class="form-group" id="concepto-destino-group" style="display: none;">
                <label for="concepto-destino">Concepto Destino (para traslados):</label>
                <select id="concepto-destino" class="form-control">
                    <!-- Opciones se llenarán dinámicamente -->
                </select>
            </div>
            
            <div class="form-group">
                <label for="valor-modificacion">Valor (millones):</label>
                <input type="number" id="valor-modificacion" class="form-control" min="0">
            </div>

            <div class="form-group" id="distribucion-gasto" style="display: none;">
                <label>Distribución del Valor (Debe sumar exactamente el valor ingresado):</label>
                <div class="info-valor-distribucion" style="background-color: #e9ecef; padding: 10px; margin-bottom: 10px; border-radius: 4px; display: none;">
                    <strong>Valor a distribuir: <span id="valor-total-distribucion">0</span> millones</strong>
                    <br>
                    <span>Suma actual: <span id="suma-actual-distribucion" style="color: #007bff;">0</span> millones</span>
                    <span id="diferencia-distribucion" style="margin-left: 10px;"></span>
                </div>
                <div id="distribucion-contenedor"></div>
                <div style="margin-top: 10px;">
                    <button type="button" id="agregar-distribucion" class="btn-secundario">+ Añadir línea</button>
                    <button type="button" id="guardar-distribucion" class="btn-principal">Registrar distribución</button>
                </div>
            </div>


            
            <div class="form-group">
                <label for="justificacion-modificacion">Justificación:</label>
                <textarea id="justificacion-modificacion" class="form-control" rows="3"></textarea>
            </div>
            
            <button id="agregar-modificacion">Agregar Modificación</button>
            
            <div class="contador-modificaciones" style="margin: 15px 0; padding: 10px; background-color: #f8f9fa; border-radius: 4px; text-align: center;">
                <strong>📊 Modificaciones registradas: <span id="contador-mods">0</span></strong>
            </div>
            
            <h3>Historial de Modificaciones</h3>
            <table id="modificaciones-table">
                <thead>
                    <tr>
                        <th>Tipo</th>
                        <th>Área</th>
                        <th>Concepto</th>
                        <th>Concepto Destino</th>
                        <th>Valor</th>
                        <th>Justificación</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Se llenará dinámicamente -->
                </tbody>
            </table>
            
            <h3>Presupuesto Actualizado</h3>
            <div class="tabs">
            
            </div>
            
            <div id="ingresos-act" class="subtab-content active">
                <table id="ingresos-actualizados-table">
                    <thead>
                        <tr>
                            <th>Concepto</th>
                            <th>Proyección Inicial</th>
                            <th>Modificaciones</th>
                            <th>Total Actualizado</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Se llenará dinámicamente -->
                    </tbody>
                </table>
            </div>
            
            <div id="gastos-act" class="subtab-content">
                <table id="gastos-actualizados-table">
                    <thead>
                        <tr>
                            <th>Concepto</th>
                            <th>Proyección Inicial</th>
                            <th>Modificaciones</th>
                            <th>Total Actualizado</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Se llenará dinámicamente -->
                    </tbody>
                </table>
            </div>
            
            <div id="balance-modificaciones" class="alert" style="display: none;"></div>
        </div>
        
        <!-- Indicadores Presupuestales -->
        <div id="indicadores" class="tab-content">
            <div class="instructions">
                <h3>Indicadores Presupuestales</h3>
                <p>A continuación se presentan los principales indicadores calculados automáticamente a partir de su presupuesto. Estos indicadores le ayudarán a evaluar la salud financiera del municipio.</p>
            </div>
            


            
            <table id="indicadores-table">
                <thead>
                    <tr>
                        <th>Indicador</th>
                        <th>Fórmula</th>
                        <th>Valor</th>
                        <th>Interpretación</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Ejecución de Ingresos</td>
                        <td>(Recaudado / Presupuestado) * 100</td>
                        <td><span id="ejecucion-ingresos">0</span>%</td>
                        <td id="interpretacion-ejecucion-ingresos">-</td>
                    </tr>
                    <tr>
                        <td>Ejecución de Gastos</td>
                        <td>(Ejecutado / Presupuestado) * 100</td>
                        <td><span id="ejecucion-gastos">0</span>%</td>
                        <td id="interpretacion-ejecucion-gastos">-</td>
                    </tr>
                    <tr>
                        <td>Relación Funcionamiento / Gasto Total</td>
                        <td>(Gastos Funcionamiento / Gastos Totales) * 100</td>
                        <td><span id="relacion-funcionamiento">0</span>%</td>
                        <td id="interpretacion-funcionamiento">-</td>
                    </tr>
                    <tr>
                        <td>Relación Inversión / Gasto Total</td>
                        <td>(Gastos Inversión / Gastos Totales) * 100</td>
                        <td><span id="relacion-inversion">0</span>%</td>
                        <td id="interpretacion-inversion">-</td>
                    </tr>
                    <tr>
                        <td>Dependencia de Transferencias</td>
                        <td>(Transferencias / Ingresos Totales) * 100</td>
                        <td><span id="dependencia-transferencias">0</span>%</td>
                        <td id="interpretacion-transferencias">-</td>
                    </tr>
                </tbody>
            </table>
            

        </div>
        
        <!-- Análisis Presupuestal -->
        <div id="analisis" class="tab-content">
            <div class="instructions">
                <h3>Análisis Presupuestal</h3>
                <p>Realice aquí su análisis cualitativo del comportamiento presupuestal basado en los indicadores calculados. Considere aspectos como sostenibilidad financiera, priorización de gastos, dependencia de transferencias, entre otros.</p>
            </div>
            
            <div class="form-group">
                <label for="analisis-texto">Análisis:</label>
                <textarea id="analisis-texto" class="form-control" rows="10" placeholder="Escriba aquí su análisis..."></textarea>
            </div>
            
            <button id="guardar-analisis">Guardar Análisis</button>
                    <!-- En el div con id="analisis" -->
<div class="form-group">
    <button id="generar-pdf" class="btn-exportar">Generar Reporte PDF</button>
</div>
            
            <h3>Resumen de Indicadores</h3>
            <div id="resumen-indicadores">
                <!-- Se llenará dinámicamente -->
            </div>
            
            <h3>Recomendaciones Automáticas</h3>
            <div id="recomendaciones" class="alert">
                <!-- Se generarán automáticamente -->
            </div>
        </div>
    </div>
    
    <footer>
        <p>Herramienta de asistencia para Presupuesto Público - Harold Andres Lopez Sepulveda </p>
        <p> Desarrollada por: Santiago Martinez Serna - © 2025</p>
        <button id="exportar-datos">Exportar Datos</button>
       
    </footer>

    <!-- Agrega esto antes del script de app.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <script src="script.js"></script>
</body>
</html>